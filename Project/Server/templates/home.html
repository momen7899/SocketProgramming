<!DOCTYPE html>
<html lang="en">
<head>
    <title>Home</title>
    <meta charset="UTF-8"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<h>List of Users you can choose</h>
<ul class="user_holder">
    <button onclick="itemClicked(-1,'')">Group</button>
</ul>

<script>
    let baseUrl = 'http://' + document.domain + ':' + location.port
    let senderId = sessionStorage.getItem("id");
    let senderName = sessionStorage.getItem("username")
    let url = baseUrl + '/api/getUsers?userId=' + senderId

    $.ajax({
        url: url,
        type: 'get',
        success: function (response) {
            response.forEach(function (user) {
                $('ul.user_holder').append(`<button onclick="itemClicked(${user.id},${user.username})">${user.username}</button>`)
            })
        },
        error: function () {
            alert("Couldn't load items:(");
        }
    });

    function itemClicked(id, name) {
        console.log(id)
        console.log(name)

        sessionStorage.setItem("senderId", senderId);
        sessionStorage.setItem("senderName", senderName);
        sessionStorage.setItem("receiverId", id);
        location.replace(baseUrl + "/chat")
    }
</script>


</body>
</html>